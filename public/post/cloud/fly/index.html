<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Fly.io 免费PaaS平台，以及哪吒面板的部署 - FAKEV</title><meta name="Description" content="a IT blog"><meta property="og:title" content="Fly.io 免费PaaS平台，以及哪吒面板的部署" />
<meta property="og:description" content="fly.io 类似于Okteto、Heroku和Railway的PaaS平台。 只能通过CLI登录，对小白可能有些不太友好。 官网：fly.io 免费额度：F" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://fakev.cn/post/cloud/fly/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-07T15:06:48+08:00" />
<meta property="article:modified_time" content="2022-02-07T15:06:48+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Fly.io 免费PaaS平台，以及哪吒面板的部署"/>
<meta name="twitter:description" content="fly.io 类似于Okteto、Heroku和Railway的PaaS平台。 只能通过CLI登录，对小白可能有些不太友好。 官网：fly.io 免费额度：F"/>
<meta name="application-name" content="FAKEV">
<meta name="apple-mobile-web-app-title" content="FAKEV"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://fakev.cn/post/cloud/fly/" /><link rel="prev" href="https://fakev.cn/post/elastic/filebeat/" /><link rel="next" href="https://fakev.cn/post/devops/docker/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Fly.io 免费PaaS平台，以及哪吒面板的部署",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/fakev.cn\/post\/cloud\/fly\/"
        },"genre": "post","keywords": "白嫖, cloud, PaaS","wordcount":  927 ,
        "url": "https:\/\/fakev.cn\/post\/cloud\/fly\/","datePublished": "2022-02-07T15:06:48+08:00","dateModified": "2022-02-07T15:06:48+08:00","publisher": {
            "@type": "Organization",
            "name": "lyj"},"author": {
                "@type": "Person",
                "name": "lyj"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="FAKEV">FAKEV</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> 主页 </a><a class="menu-item" href="/post/"> 历史 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="FAKEV">FAKEV</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">主页</a><a class="menu-item" href="/post/" title="">历史</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animated pulse faster">Fly.io 免费PaaS平台，以及哪吒面板的部署</h1><div class="content" id="content"><h2 id="flyio">fly.io</h2>
<p>类似于Okteto、Heroku和Railway的PaaS平台。</p>
<p>只能通过CLI登录，对小白可能有些不太友好。</p>
<p>官网：fly.io</p>
<p>免费额度：Fly App Pricing 免费额度有三个不间断运行的容器，以及160G的出站流量。(东亚30g，欧美100g，印度30g)</p>
<h2 id="使用以部署哪吒面板为例">使用(以部署哪吒面板为例)</h2>
<ol>
<li>
<p>安装fly cli</p>
</li>
<li>
<p>把哪吒源码下下来，需要进行一些修改</p>
</li>
<li>
<p>修改cmd/dashboad/main.go ,在<code>init</code>函数下加上</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">	<span class="c1">//新建conf文件
</span><span class="c1"></span>	<span class="nx">file6</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;data/config.yaml&#34;</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="nx">data</span> <span class="o">:=</span> <span class="s">`debug: false
</span><span class="s">httpport: 80
</span><span class="s">grpcport: 5555
</span><span class="s">oauth2:
</span><span class="s">  type: &#34;github&#34; #Oauth2 登录接入类型，gitee/github
</span><span class="s">  admin: &#34;{你的github用户名}&#34; #管理员列表，半角逗号隔开
</span><span class="s">  clientid: &#34;&#34; # 在 https://github.com/settings/developers 创建，无需审核 Callback 填 http(s)://域名或IP/oauth2/callback
</span><span class="s">  clientsecret: &#34;&#34;
</span><span class="s">site:
</span><span class="s">  brand: &#34;xxx&#34;
</span><span class="s">  cookiename: &#34;nezha-dashboard&#34; #浏览器 Cookie 字段名，可不改
</span><span class="s">  theme: &#34;default&#34;
</span><span class="s">`</span>
	<span class="nx">file6</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
	<span class="nx">file6</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>这样就相当于可以直接嵌入文件</p>
<ol start="4">
<li>
<p>为了使数据持久话，我们需要添加volume,fly提供3g免费空间，我们新建一个g就行，<code>fly volumes create nz_data --region hkg --size 1</code></p>
</li>
<li>
<p>运行<code>fly launch</code> 生成<code>fly.toml</code>文件，修改成</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="c"># fly.toml file generated for nz on 2022-02-07T02:08:50+08:00</span>

<span class="nx">app</span> <span class="p">=</span> <span class="s2">&#34;nz&#34;</span>

<span class="nx">kill_signal</span> <span class="p">=</span> <span class="s2">&#34;SIGINT&#34;</span>
<span class="nx">kill_timeout</span> <span class="p">=</span> <span class="mi">5</span>
<span class="nx">processes</span> <span class="p">=</span> <span class="p">[]</span>

<span class="p">[</span><span class="nx">env</span><span class="p">]</span>

<span class="p">[</span><span class="nx">experimental</span><span class="p">]</span>
  <span class="nx">allowed_public_ports</span> <span class="p">=</span> <span class="p">[]</span>
  <span class="nx">auto_rollback</span> <span class="p">=</span> <span class="kc">true</span>

<span class="p">[</span><span class="nx">mounts</span><span class="p">]</span>
  <span class="nx">destination</span> <span class="p">=</span> <span class="s2">&#34;/dashboard/data&#34;</span>
  <span class="nx">source</span> <span class="p">=</span> <span class="s2">&#34;nz_data&#34;</span>

<span class="p">[[</span><span class="nx">services</span><span class="p">]]</span>
  <span class="nx">http_checks</span> <span class="p">=</span> <span class="p">[]</span>
  <span class="nx">internal_port</span> <span class="p">=</span> <span class="mi">80</span>
  <span class="nx">processes</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;app&#34;</span><span class="p">]</span>
  <span class="nx">protocol</span> <span class="p">=</span> <span class="s2">&#34;tcp&#34;</span>
  <span class="nx">script_checks</span> <span class="p">=</span> <span class="p">[]</span>

  <span class="p">[</span><span class="nx">services</span><span class="p">.</span><span class="nx">concurrency</span><span class="p">]</span>
    <span class="nx">hard_limit</span> <span class="p">=</span> <span class="mi">25</span>
    <span class="nx">soft_limit</span> <span class="p">=</span> <span class="mi">20</span>
    <span class="nx">type</span> <span class="p">=</span> <span class="s2">&#34;connections&#34;</span>

  <span class="p">[[</span><span class="nx">services</span><span class="p">.</span><span class="nx">ports</span><span class="p">]]</span>
    <span class="nx">handlers</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;http&#34;</span><span class="p">]</span>
    <span class="nx">port</span> <span class="p">=</span> <span class="mi">80</span>

  <span class="p">[[</span><span class="nx">services</span><span class="p">.</span><span class="nx">ports</span><span class="p">]]</span>
    <span class="nx">handlers</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;tls&#34;</span><span class="p">,</span> <span class="s2">&#34;http&#34;</span><span class="p">]</span>
    <span class="nx">port</span> <span class="p">=</span> <span class="mi">443</span>

  <span class="p">[[</span><span class="nx">services</span><span class="p">.</span><span class="nx">tcp_checks</span><span class="p">]]</span>
    <span class="nx">grace_period</span> <span class="p">=</span> <span class="s2">&#34;1s&#34;</span>
    <span class="nx">interval</span> <span class="p">=</span> <span class="s2">&#34;15s&#34;</span>
    <span class="nx">restart_limit</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">timeout</span> <span class="p">=</span> <span class="s2">&#34;2s&#34;</span>

<span class="p">[[</span><span class="nx">services</span><span class="p">]]</span>
  <span class="nx">http_checks</span> <span class="p">=</span> <span class="p">[]</span>
  <span class="nx">internal_port</span> <span class="p">=</span> <span class="mi">5555</span>
  <span class="nx">processes</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;app&#34;</span><span class="p">]</span>
  <span class="nx">protocol</span> <span class="p">=</span> <span class="s2">&#34;tcp&#34;</span>
  <span class="nx">script_checks</span> <span class="p">=</span> <span class="p">[]</span>

  <span class="p">[</span><span class="nx">services</span><span class="p">.</span><span class="nx">concurrency</span><span class="p">]</span>
    <span class="nx">hard_limit</span> <span class="p">=</span> <span class="mi">25</span>
    <span class="nx">soft_limit</span> <span class="p">=</span> <span class="mi">20</span>
    <span class="nx">type</span> <span class="p">=</span> <span class="s2">&#34;connections&#34;</span>

  <span class="p">[[</span><span class="nx">services</span><span class="p">.</span><span class="nx">ports</span><span class="p">]]</span>
    <span class="nx">port</span> <span class="p">=</span> <span class="mi">5555</span>

  <span class="p">[[</span><span class="nx">services</span><span class="p">.</span><span class="nx">tcp_checks</span><span class="p">]]</span>
    <span class="nx">grace_period</span> <span class="p">=</span> <span class="s2">&#34;1s&#34;</span>
    <span class="nx">interval</span> <span class="p">=</span> <span class="s2">&#34;15s&#34;</span>
    <span class="nx">restart_limit</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">timeout</span> <span class="p">=</span> <span class="s2">&#34;2s&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>具体意思可以去fly文档看，文档还是非常详细的</p>
<ol start="6">
<li>运行<code>fly deploy</code>部署app，他会自动把你代码打包成docker镜像上传</li>
<li>大功告成，接下来你就可以去控制台看部署的结果了</li>
<li><a href="http://nz.fakev.cn" target="_blank" rel="noopener noreffer">演示站</a></li>
</ol>
<h3 id="优点">优点</h3>
<ul>
<li>不怕宕机</li>
<li>白嫖党狂喜</li>
</ul>
<h3 id="缺点">缺点</h3>
<ul>
<li>很难更新</li>
<li>备份或者迁移很难</li>
</ul>
<h2 id="后记">后记</h2>
<ul>
<li>fly.io 也是我最近才刚刚发现的，不知道能不能长久，也不知道有没有大厂背书。所以稳定性还有待观察</li>
<li>注册fly是要用信用卡的，一般的卡都能过，会交易10美元，所以卡里面最好大于10美元，啥卡都行，没卡的去微信搞个易呗卡</li>
<li>虽说是部署在香港的，但是ipv4解析到的地方是英国，所以访问速度不是很快，ipv6解到的是新加坡</li>
</ul>
<h2 id="参考文献">参考文献</h2>
<ul>
<li><a href="https://liusy.eu.org/tag/fly-io/" target="_blank" rel="noopener noreffer">https://liusy.eu.org/tag/fly-io/</a></li>
<li><a href="https://dnslin.com/index.php/archives/37.html" target="_blank" rel="noopener noreffer">https://dnslin.com/index.php/archives/37.html</a></li>
<li><a href="https://blog.kermsite.com/p/flyio/" target="_blank" rel="noopener noreffer">https://blog.kermsite.com/p/flyio/</a></li>
</ul>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.92.1">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">lyj</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
